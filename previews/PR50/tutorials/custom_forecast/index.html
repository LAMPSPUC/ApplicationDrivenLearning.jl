<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Custom forecast models · ApplicationDrivenLearning.jl documentation</title><meta name="title" content="Custom forecast models · ApplicationDrivenLearning.jl documentation"/><meta property="og:title" content="Custom forecast models · ApplicationDrivenLearning.jl documentation"/><meta property="twitter:title" content="Custom forecast models · ApplicationDrivenLearning.jl documentation"/><meta name="description" content="Documentation for ApplicationDrivenLearning.jl documentation."/><meta property="og:description" content="Documentation for ApplicationDrivenLearning.jl documentation."/><meta property="twitter:description" content="Documentation for ApplicationDrivenLearning.jl documentation."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ApplicationDrivenLearning.jl documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting started with ApplicationDrivenLearning</a></li><li><a class="tocitem" href="../modes/">Training modes</a></li><li class="is-active"><a class="tocitem" href>Custom forecast models</a><ul class="internal"><li><a class="tocitem" href="#Input-Output-mapping"><span>Input-Output mapping</span></a></li><li><a class="tocitem" href="#Multiple-Flux-models"><span>Multiple Flux models</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/scheduling/">Minimal Scheduling Problem</a></li><li><a class="tocitem" href="../../examples/newsvendor/">Newsvendor Problem</a></li></ul></li><li><a class="tocitem" href="../../reference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Custom forecast models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Custom forecast models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/LAMPSPUC/ApplicationDrivenLearning.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/LAMPSPUC/ApplicationDrivenLearning.jl/blob/main/docs/src/tutorials/custom_forecast.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Custom-forecast-models"><a class="docs-heading-anchor" href="#Custom-forecast-models">Custom forecast models</a><a id="Custom-forecast-models-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-forecast-models" title="Permalink"></a></h1><p>The basic approach to define a forecast model is to use a <code>Chain</code> from the <code>Flux.jl</code> package, that directly maps the input to the output. But there are cases where this approach is not enough.</p><h2 id="Input-Output-mapping"><a class="docs-heading-anchor" href="#Input-Output-mapping">Input-Output mapping</a><a id="Input-Output-mapping-1"></a><a class="docs-heading-anchor-permalink" href="#Input-Output-mapping" title="Permalink"></a></h2><p>The connection between predictive model outputs and plan model inputs is not always a straightforward one. Because of this, the <code>set_forecast_model</code> function, used to define the predictive model in the ApplicationDrivenLearning.jl package, includes the <code>input_output_map</code> parameter. This parameter allows users to declare an explicit mapping between the outputs produced by Flux models and the forecast variables used in the planning model. This is useful in contexts where the same prediction logic can be applied across several entities (such as production units or geographical locations), promoting model reuse and computational efficiency.</p><p>Consider a scenario where the input dataset contains 3 predictive variables (for example expected temperature on location 1, expected temperature on location 2 and weekday), there are 2 forecast variables (energy demand on the two locations of interest) and the forecast model should use only the expected temperature of a location to predict it’s demand. That means we would make two predictions using the same model and concatenate those values. This can be easily achieved with a dictionary mapping the data input and forecast variable indexes.</p><pre><code class="language-julia hljs">X = [
    76 89 2;
    72 85 3
] # input dataset of size 2 by 3
dem_forecast = Dense(
    2 =&gt; 1
) # forecast model takes 2 inputs and outputs single value

input_output_map = Dict(
    [1, 3] =&gt; [1], # input indexes 1 and 3 map to 1st forecast variable
    [2, 3] =&gt; [2] # input indexes 2 and 3 map to 2nd forecast variable
)
ApplicationDrivenLearning.set_forecast_model(model, dem_forecast, input_output_map)</code></pre><h2 id="Multiple-Flux-models"><a class="docs-heading-anchor" href="#Multiple-Flux-models">Multiple Flux models</a><a id="Multiple-Flux-models-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Flux-models" title="Permalink"></a></h2><p>The definition of the predictive model can also be done using multiple Flux models. This supports the modular construction of predictive architectures, where specialized components are trained to forecast different aspects of the problem, without the difficulty of defining custom architectures.</p><p>This can be achieved providing an array of model objects and an array of dictionaries as input-output mapping to the <code>set_forecast_model</code> function. Using the context from previous example, let’s assume there is an additional variable that has to be predicted to each location but not variable on time (that is, on dataset samples). This can be achieved defining an additional model that maps a constant input value to the correct output indexes.</p><pre><code class="language-julia hljs">X = [
    76 89 2 1;
    72 85 3 1
] # input dataset of size 2 by 4
dem_forecast = Dense(
    2 =&gt; 1
) # demand forecast model takes 2 inputs and outputs single value
aux_forecast = Dense(
    1 =&gt; 2
) # auxiliar forecast model takes 1 input and outputs 2 values
forecast_objs = [dem_forecast, aux_forecast]
input_output_map = [
    Dict(
        [1, 3] =&gt; [1],
        [2, 3] =&gt; [2]
    ), # input indexes 1,2,3 are used to compute forecast vars 1,2 with 1st Flux.Dense object
    Dict(
        [4] =&gt; [3, 4]
    ), # input index 4 is used to compute forecast vars 3,4 with 2nd Flux.Dense object
]
ApplicationDrivenLearning.set_forecast_model(model, forecast_objs, input_output_map)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../modes/">« Training modes</a><a class="docs-footer-nextpage" href="../../examples/scheduling/">Minimal Scheduling Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 21 January 2026 13:30">Wednesday 21 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
